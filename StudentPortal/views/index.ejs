<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ton Duc Thang University Social network</title>
    <%- include partial/cdn.ejs %>
    <style>
        .index-page .notification .mt-70 {
            margin-top: 70px;
        }

        .index-page .notification .mb-70 {
            margin-bottom: 70px;
        }

        .index-page .notification .card {
            box-shadow: 0 0.46875rem 2.1875rem rgba(4, 9, 20, 0.03), 0 0.9375rem 1.40625rem rgba(4, 9, 20, 0.03), 0 0.25rem 0.53125rem rgba(4, 9, 20, 0.05), 0 0.125rem 0.1875rem rgba(4, 9, 20, 0.03);
            border-width: 0;
            transition: all 0.2s;
        }

        .index-page .notification .card {
            position: relative;
            display: flex;
            flex-direction: column;
            min-width: 0;
            word-wrap: break-word;
            background-color: #fff;
            background-clip: border-box;
            border: 1px solid rgba(26, 54, 126, 0.125);
            border-radius: 0.25rem;
        }

        .index-page .notification .card-body {
            flex: 1 1 auto;
            padding: 1.25rem;
            max-height: 800px;
            overflow-y: scroll;
        }

        .index-page .notification .card-body::-webkit-scrollbar {
            width: 5px;
        }

        /* Track */
        .index-page .notification .card-body::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        /* Handle */
        .index-page .notification .card-body::-webkit-scrollbar-thumb {
            border-radius: 1rem;
            background-color: #aa00ff;
            background-image: linear-gradient(to top, #aa00ff 0%, #3a73d5 100%);

        }

        /* Handle on hover */
        .index-page .notification .card-body::-webkit-scrollbar-thumb:hover {
            background: #aa00ff;
        }

        .index-page .notification .vertical-timeline {
            width: 100%;
            position: relative;
            padding: 1.5rem 0 1rem;

        }

        .index-page .notification .vertical-timeline::before {
            content: '';
            position: absolute;
            top: 0;
            left: 67px;
            height: 100%;
            width: 4px;
            background: #e9ecef;
            border-radius: 0.25rem;
        }

        .index-page .notification .vertical-timeline-element {
            position: relative;
            margin: 0 0 1rem;
        }

        .index-page .notification .vertical-timeline--animate .vertical-timeline-element-icon.bounce-in {
            visibility: visible;
            animation: cd-bounce-1 0.8s;
        }

        .index-page .notification .vertical-timeline-element-icon {
            position: absolute;
            top: 0;
            left: 60px;
        }

        .index-page .notification .vertical-timeline-element-icon .badge-dot-xl {
            box-shadow: 0 0 0 5px #fff;
        }

        .index-page .notification .badge-dot-xl {
            width: 18px;
            height: 18px;
            position: relative;
        }

        .index-page .notification .badge:empty {
            display: none;
        }

        .index-page .notification .badge-dot-xl::before {
            content: '';
            width: 10px;
            height: 10px;
            border-radius: 0.25rem;
            position: absolute;
            left: 50%;
            top: 50%;
            margin: -5px 0 0 -5px;
            background: #fff;
        }

        .index-page .notification .vertical-timeline-element-content {
            position: relative;
            margin-left: 90px;
            font-size: 0.8rem;
        }

        .index-page .notification .vertical-timeline-element-content .timeline-title {
            font-size: 0.8rem;
            text-transform: uppercase;
            margin: 0 0 0.5rem;
            padding: 2px 0 0;
            font-weight: bold;
        }

        .index-page .notification .vertical-timeline-element-content .vertical-timeline-element-date {
            display: block;
            position: absolute;
            left: -90px;
            top: 0;
            padding-right: 10px;
            text-align: right;
            color: #adb5bd;
            font-size: 0.7619rem;
            white-space: nowrap;
        }

        .index-page .notification .vertical-timeline-element-content:after {
            content: "";
            display: table;
            clear: both;
        }

        @keyframes ldio-5zwd5fyq11k {
            0% {
                transform: rotate(0deg)
            }

            50% {
                transform: rotate(180deg)
            }

            100% {
                transform: rotate(360deg)
            }
        }

        .ldio-5zwd5fyq11k div {
            position: absolute;
            animation: ldio-5zwd5fyq11k 1s linear infinite;
            width: 88.4px;
            height: 88.4px;
            top: 66.3px;
            left: 66.3px;
            border-radius: 50%;
            box-shadow: 0 5.525px 0 0 #5b86e1;
            transform-origin: 44.2px 46.9625px;
        }

        .loadingio-spinner-eclipse-xfa10kxbc8e {
            width: 221px;
            height: 221px;
            display: inline-block;
            overflow: hidden;
            background: #ffffff;
        }

        .ldio-5zwd5fyq11k {
            width: 100%;
            height: 100%;
            position: relative;
            transform: translateZ(0) scale(1);
            backface-visibility: hidden;
            transform-origin: 0 0;
            /* see note above */
        }

        .ldio-5zwd5fyq11k div {
            box-sizing: content-box;
            position: absolute;
            left: 40%;
            transform: translate(-50%, 0);
        }
        .spinerLoadingNotification{
            height: 30px;
        }
        .spinerLoadingNotification{
            display: none;
        }
        .spinerLoadingNotification p{
            display: none;
            z-index: 1;
        }
        .index-page .notification .vertical-timeline-element-content {
            position: relative;
            margin-left: 110px;
            font-size: 0.8rem;
        }
        .index-page .notification .vertical-timeline::before {
            left: 97px;
        }
        .index-page .notification .vertical-timeline-element-content .vertical-timeline-element-date {
            left: -110px;
        }
        .index-page .notification .vertical-timeline-element-icon {
            left: 92px;
        }

        /* generated by https://loading.io/ */

        
    </style>

    <style>
        .index-page .gap2 .loader,
        .index-page .gap2 .loader:before,
        .index-page .gap2 .loader:after {
            border-radius: 50%;
            width: 1.2em;
            height: 1.2em;
            -webkit-animation-fill-mode: both;
            animation-fill-mode: both;
            -webkit-animation: load7 1.8s infinite ease-in-out;
            animation: load7 1.8s infinite ease-in-out;
        }
        .index-page .gap2 .loader {
            color: #706969;
            font-size: 10px;
            margin: 0px auto;
            position: relative;
            text-indent: -9999em;
            -webkit-transform: translateZ(0);
            -ms-transform: translateZ(0);
            transform: translateZ(0);
            -webkit-animation-delay: -0.16s;
            animation-delay: -0.16s;
        }
        .index-page .gap2 .loader:before,
        .index-page .gap2 .loader:after {
            content: '';
            position: absolute;
            top: 0;
        }
        .index-page .gap2 .loader:before {
            left: -3.5em;
            -webkit-animation-delay: -0.32s;
            animation-delay: -0.32s;
        }
        .index-page .gap2 .loader:after {
            left: 3.5em;
        }
        @-webkit-keyframes load7 {
        0%,
        80%,
            100% {
                box-shadow: 0 2.5em 0 -1.3em;
            }
            40% {
                box-shadow: 0 2.5em 0 0;
            }
        }
        @keyframes load7 {
        0%,
        80%,
            100% {
                box-shadow: 0 2.5em 0 -1.3em;
            }
            40% {
                box-shadow: 0 2.5em 0 0;
            }
        }
    </style>

    <style>
        .index-page #back-to-top-button {
            display: inline-block;
            background-color: #dbd4c9;
            width: 50px;
            height: 50px;
            text-align: center;
            border-radius: 4px;
            position: fixed;
            bottom: 30px;
            right: 30px;
            transition: background-color .3s, 
                opacity .5s, visibility .5s;
            opacity: 0;
            visibility: hidden;
            z-index: 1000;
        }
        .index-page #back-to-top-button::after {
            content: "\f077";
            font-family: "Font Awesome 5 Pro";
            font-weight: normal;
            font-style: normal;
            font-size: 2em;
            line-height: 50px;
            color: #fff;
        }
        .index-page #back-to-top-button:hover {
            cursor: pointer;
            background-color: #333;
        }
        .index-page #back-to-top-button:active {
            background-color: #555;
        }
        .index-page #back-to-top-button.show {
            opacity: 1;
            visibility: visible;
        }

        /* Show user like status */

        .index-page .showUserLikeModal .showUserLikeImg {
            width: 35px;
            height: 35px;
            border-radius: 100%;
        }
        .index-page .showUserLikeModal .cardShowUserLike {
            margin: 20px;
        }
        .index-page .showUserLikeModal .listCardUserLike {
            overflow-y: inherit;
        }
        .index-page .showUserLikeModal .cardShowUserLike .nameUserLike {
            margin-left: 20px;
        }
    </style>
</head>

<body>
    <div class="index-page">
        <div class="postoverlay"></div>

        <%- include partial/responsiveMenu.ejs %>
        <%- include partial/topbar.ejs %>
        <%- include partial/header-leftbar.ejs %>

        <section>
            <div class="gap2 gray-bg">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="row merged20" id="page-contents">
                                <!-- <div class="col-lg-1">
                                    <aside class="sidebar static left">
                                        <div class="widget">
                                        </div>
                                    </aside>
                                </div> -->

                                <div class="col-lg-7">
                                    <form method="post" enctype="multipart/form-data">
                                        <div class="central-meta postbox">
                                            <span class="create-post">Create post</span>
                                            <div class="new-postbox">
                                                <figure>
                                                    <img src="<%= user.image %>" alt="">
                                                </figure>
                                                <div class="newpst-input">
                                                    <form method="post">
                                                        <textarea class="statusTitle" name="statusTitle" rows="2"
                                                            placeholder="Chia sẻ một thứ gì đó mà bạn nghĩ đến ?"></textarea>
                                                    </form>
                                                </div>
                                                <div class="attachments">
                                                    <ul>
                                                        <li>
                                                            <i class="fa fa-image"></i>
                                                            <label class="fileContainer">
                                                                <input type="file" name="imageStatus" id="imageUpload"
                                                                    accept="image/*">
                                                            </label>
                                                        </li>
                                                        <li>
                                                            <i class="fas fa-video"></i>
                                                            <label class="fileContainer">
                                                                <input type="file">
                                                            </label>
                                                        </li>
                                                        <li>
                                                            <i class="fa fa-camera"></i>
                                                            <label class="fileContainer">
                                                                <input type="file">
                                                            </label>
                                                        </li>
                                                        <li class="preview-btn">
                                                            <button class="post-btn-preview" type="button"
                                                                data-ripple="">Xem lại</button>
                                                        </li>
                                                    </ul>

                                                    <div class="preview-image-upload">
                                                        <div class="card card-outline-danger image-upload-preview" style="display: none">
                                                            <span class="pull-right clickable close-icon close-preview-image" data-effect="fadeOut"><i class="fa fa-times"></i></span>
                                                            <div class="card-block">
                                                                <img id="output" width="200px">
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <button data-image="<%= user.image %>" data-name="<%= user.name %>"
                                                        data-id="<%= user.id %>" class="post-btn" type="button"
                                                        data-ripple="">Đăng</button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <div class="multi-card">
                                        <% locals.allStatus.forEach(status=> { %>
                                        <!-- The Modal -->
                                        <div class="modal fade showUserLikeModal" id="showUserLikeModal<%= status._id %>">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                
                                                    <!-- Modal Header -->
                                                    <div class="modal-header">
                                                        <h4 class="modal-title">Số người thích bài viết</h4>
                                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                    </div>
                                                    
                                                    <!-- Modal body -->
                                                    <div class="modal-body listCardUserLike">
                                                        <% status.like.forEach(l => { %>
                                                            <div class="cardShowUserLike">
                                                                <img src="<%= l.image %>" alt="" class="showUserLikeImg">
                                                                <span class="nameUserLike"><%= l.name %></span>
                                                            </div>
                                                        <% }) %>
                                                    </div>
                                                    
                                                    <!-- Modal footer -->
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-success" data-dismiss="modal">Close</button>
                                                    </div>
                                                    
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card">
                                            <!--Information of post's user-->
                                            <div class="d-flex justify-content-between p-2 px-2">
                                                <div class="d-flex flex-row align-items-center">
                                                    <img src="<%= JSON.parse(status.author).image %>" alt=""
                                                        class="image-user rounded-circle" width="52">
                                                    <div class="d-flex flex-column ml-2">
                                                        <span class="font-weight-bold">
                                                            <%= JSON.parse(status.author).fullName %>
                                                        </span>
                                                        <small class="text-primary">Thông tin</small>
                                                    </div>
                                                </div>
                                                <!--Time and more-->
                                                <div class="time-and-more d-flex flex-row mt-2">
                                                    <small class="mr-2">
                                                        <%= status.currentTime %>
                                                    </small><i class="fas fa-ellipsis-v"></i>
                                                </div>
                                            </div>
                                            <!--Area of post-->
                                            <hr style="border: none;">
                                            <p class="text-justify ml-3 statusId">
                                                <%= status.statusTitle %>
                                            </p>
                                            <img src="<%= status.image %>" alt="" class="img-fluid">
                                            <!-- Number of Comment and Interactive-->
                                            <div class="d-flex justify-content-between align-items-centerl">
                                                <div
                                                    class="d-flex flex-row icons d-flex align-items-center ml-3 interactive_color">
                                                    <span><i class="fa fa-thumbs-up"></i> <a
                                                            class="view-<%= status._id %>" href="#" data-toggle="modal" data-target=".index-page #showUserLikeModal<%= status._id %>">
                                                            <%= status.like.length %>
                                                        </a> </span>
                                                </div>
                                                <div class="d-flex flex-row interactive_color m-3">
                                                    <span class="mr-3 cmt">Bình luận</span>
                                                    <span class="shares">Chia sẻ</span>
                                                </div>
                                            </div>
                                            <hr>
                                            <!--Interative-->
                                            <div class="d-flex justify-content-between align-items-centerl mx-5">
                                                <% if (status.checkLike) { %>
                                                <div class="like liked <%= status._id %>" onclick="getLikeStatus(this)"
                                                    data-userid="<%= user._id %>" data-name="<%= user.name %>"
                                                    data-image="<%= user.image %>" data-id="<%= status._id %>"">
                                                            <i class=" fa fa-thumbs-up"></i> <span>Thích</span>
                                                </div>
                                                <% } else { %>
                                                <div class="like <%= status._id %>" onclick="getLikeStatus(this)"
                                                    data-userid="<%= user._id %>" data-name="<%= user.name %>"
                                                    data-image="<%= user.image %>" data-id="<%= status._id %>"">
                                                            <i class=" fa fa-thumbs-up"></i> <span>Thích</span>
                                                </div>
                                                <% } %>
                                                <div class="cmts">
                                                    <i class="fa fa-comments"></i> <span>Bình
                                                        luận</span>
                                                </div>
                                                <div class="shr">
                                                    <i class="fa fa-share-square"></i> <span>Chia
                                                        sẻ</span>
                                                </div>
                                            </div>
                                            <hr>
                                            <!--Comment-->
                                            <div class="comments mx-3 comments<%= status._id %>">
                                                <% if (status.comments.length !== 0) { %>
                                                    <% status.comments.forEach(comment => { %>
                                                        <div class="d-flex flex-row mb-2">
                                                            <img src="<%= comment.imgAuthor %>" width="40" class="round-img">
                                                            <div class="d-flex flex-column ml-2">
                                                                <span class="nameOfUser"><%= comment.nameAuthor %></span>
                                                                <small class="comment-text"><%= comment.content %></small>
                                                                <div
                                                                    class="d-flex flex-row align-items-center interactive_comment_color">
                                                                    <small>Thích</small>
                                                                    <small>Trả lời</small>
                                                                    <small>Dịch</small>
                                                                    <small><%= comment.dateModified %></small>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    <% }) %>
                                                <% } %>
                                                <div class="comment-input"> 
                                                    <input type="text" class="form-control" id="text-content-comment<%= status._id %>">
                                                    <div class="fonts send-comment" data-author="<%= user._id %>" data-status = "<%= status._id %>" onclick="fetchApiComment(this)">
                                                        <i class="fas fa-paper-plane"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <% }) %>
                                    </div>
                                </div>
                                <div class="col-lg-5">
                                    <div class="notification">
                                        <div class="row d-flex justify-content-center mt-0 ">
                                            <div class="col-md-12">
                                                <div class="main-card mb-3 card">
                                                    <div class="card-body notification-body">
                                                        <h5 class="card-title mb-0">Thông báo gần đây</h5>
                                                        <p class="text-right mb-0"><a href="/notification"
                                                                class="text-right">Xem tất cả</a></p>
                                                        <div class="loading loadingio-spinner-eclipse-xfa10kxbc8e w-100 ">
                                                            <div class="ldio-5zwd5fyq11k d-flex justify-content-center">
                                                                <div></div>
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="vertical-timeline vertical-timeline--animate vertical-timeline--one-column">

                                                            <div class="spinerLoadingNotification d-flex justify-content-center">
                                                                <div class="spinner-border" role="status">
                                                                  <span class="sr-only">Loading...</span>
                                                                </div>
                                                                <p class="hide">Đã load hết thông báo</p>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <div class="loader">Loading...</div>
                        </div>
                    </div>

                </div>
            </div>

            <%- include partial/notification.ejs %>

        </section>

        <%- include partial/header-rightbar.ejs %>

        <!-- Back to top button -->
        <a id="back-to-top-button"></a>
    </div>

    <script src="/javascripts/main.js"></script>

</body>

</html>